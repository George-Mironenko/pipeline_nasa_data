[üá∑üá∫ –†—É—Å—Å–∫–∏–π](./README.md) | [üá¨üáß English](./README.en.md)

# üìò NASA EPIC Data Pipeline

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –ø–æ—Å—Ç—É–ø–∞—é—â–∏—Ö –∏–∑ NASA EPIC API —Å–æ —Å–ø—É—Ç–Ω–∏–∫–∞ DSCOVR. –ü–∞–π–ø–ª–∞–π–Ω —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –ø—Ä–∏–Ω—Ü–∏–ø–∞–º–∏ –∏–Ω–∂–µ–Ω–µ—Ä–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –¥–∞–Ω–Ω—ã—Ö, –∫–∞–∫ –æ–ø–∏—Å–∞–Ω–æ –≤ –∫–Ω–∏–≥–µ ¬´–û—Å–Ω–æ–≤—ã –∏–Ω–∂–µ–Ω–µ—Ä–∏–∏ –¥–∞–Ω–Ω—ã—Ö¬ª (–î–∂–æ–Ω –†–∏—Å, –ú—ç—Ç—Ç –•–æ—É—Å–ª–∏).

![–ü—Ä–∏–º–µ—Ä –ø–∞–π–ø–ª–∞–π–Ω–∞](shema_image/img_1.png)
–°—Ö–µ–º–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞

## üì¶ –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

- **Apache Airflow 3.0:** –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –ø–∞–π–ø–ª–∞–π–Ω–æ–≤.
- **PostgreSQL:** –•—Ä–∞–Ω–µ–Ω–∏–µ "—Å—ã—Ä—ã—Ö" –¥–∞–Ω–Ω—ã—Ö.
- **MongoDB:** –•—Ä–∞–Ω–µ–Ω–∏–µ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (—Å—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –∑–∞ –¥–µ–Ω—å).
- **FastAPI:** REST API –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º.
- **Docker / Docker Compose:** –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
- **Selectel S3:** –û–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö CSV.
- **Pandas:** –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö.
- **PySpark:** –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Data Lake (CSV-—Ñ–∞–π–ª–æ–≤ –∏–∑ S3).

## üîß –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–∞–π–ø–ª–∞–π–Ω

### DAG: `nasa_data_pipeline`

- –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤–µ—á–µ—Ä–æ–º.
- –ü–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∑–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –¥–µ–Ω—å –∏–∑ NASA API.
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ PostgreSQL.
- –í—ã—á–∏—Å–ª—è–µ—Ç —Å—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Ö –≤ MongoDB.

### DAG: `yearly_export_dag`

- –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ü–µ –≥–æ–¥–∞ (31 –¥–µ–∫–∞–±—Ä—è).
- –ò–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∑–∞ –≥–æ–¥ –∏–∑ PostgreSQL.
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Ö –≤ CSV-—Ñ–∞–π–ª –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –≤ Selectel S3.
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç CSV —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º PySpark.

## üåê API

–î–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ FastAPI:

- `GET /` ‚Äî –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API.
- `GET /records` ‚Äî –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π.
- `GET /records/{id}` ‚Äî –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –ø–æ ObjectId.

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É: [http://localhost:8000/docs](http://localhost:8000/docs)

## üê≥ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**

```bash
git clone https://github.com/georgiymironenko/data-nasa-pipeline.git
cd data-nasa-pipeline
```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:**

- –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.example`.
- –£–∫–∞–∂–∏—Ç–µ –≤–∞—à NASA API –∫–ª—é—á:

```env
NASA_API_KEY=your_nasa_api_key_here
```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç:**

```bash
docker-compose up --build
```

4. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –≤ Airflow:**

–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Airflow: [http://localhost:8080](http://localhost:8080)

- –ó–∞–π–¥–∏—Ç–µ: `Admin > Connections > Add Connection`

–°–æ–∑–¥–∞–π—Ç–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–ª—è MongoDB:
- Conn ID: `mongo_default`
- Conn Type: `Mongo`
- Host: `mongodb`
- Login: `airflow`
- Password: `root`
- Port: `27017`

–°–æ–∑–¥–∞–π—Ç–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–ª—è PostgreSQL:
- Conn ID: `data_nasa_base`
- Conn Type: `Postgres`
- Host: `postgres`
- Login: `airflow`
- Password: `airflow`
- Port: `5432`
- Schema: `postgres`

5. **–î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–∏—Å–∞–º:**

| –°–µ—Ä–≤–∏—Å        | –ê–¥—Ä–µ—Å                        | –õ–æ–≥–∏–Ω / –ü–∞—Ä–æ–ª—å       |
|---------------|------------------------------|-----------------------|
| Airflow       | http://localhost:8080        | airflow / airflow     |
| FastAPI       | http://localhost:8000/docs   | ‚Äî                     |
| Mongo Express | http://localhost:8081        | admin / root          |

## üóÇ S3 + Airflow

1. **–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ Airflow:**

- `data_nasa_api` ‚Äî –∫–ª—é—á NASA API.
- `AWS_ACCESS_KEY_ID`, `AWS_SECRET_ACCESS_KEY` ‚Äî –∫–ª—é—á–∏ –æ—Ç Selectel S3.

2. **–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `boto3`:**

–ï—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ ‚Äî –¥–æ–±–∞–≤—å—Ç–µ `boto3` –≤ `requirements.txt` Airflow –∏ –ø–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä.

## üìò –ö–∞—Ç–∞–ª–æ–≥ –¥–∞–Ω–Ω—ã—Ö

–î–∞–Ω–Ω—ã–µ –ø–æ—Å—Ç—É–ø–∞—é—Ç –∏–∑ NASA API:

```
https://api.nasa.gov/EPIC/api/natural/date/2019-05-30?api_key=DEMO_KEY
```

–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:

```json
"date": "2025-05-23 01:27:51",
"dscovr_j2000_position": {
  "x": 934134.275255,
  "y": 1072103.780608,
  "z": 512460.978068
},
```

–ö–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å —Ç–∞–∫–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Å—ã–ª–∫—É –Ω–∞ —Å–Ω–∏–º–æ–∫ –ó–µ–º–ª–∏ —Å –∫–∞–º–µ—Ä—ã —Å–ø—É—Ç–Ω–∏–∫–∞:

```
https://api.nasa.gov/EPIC/archive/natural/2019/05/30/png/epic_1b_20190530011359.png?api_key=DEMO_KEY
```

## üß† –ê–≤—Ç–æ—Ä

**–ì–µ–æ—Ä–≥–∏–π –ú–∏—Ä–æ–Ω–µ–Ω–∫–æ**, 18 –ª–µ—Ç  
–ü—Ä–æ–µ–∫—Ç –≤–¥–æ—Ö–Ω–æ–≤–ª—ë–Ω –∫–Ω–∏–≥–æ–π *¬´–û—Å–Ω–æ–≤—ã –∏–Ω–∂–µ–Ω–µ—Ä–∏–∏ –¥–∞–Ω–Ω—ã—Ö¬ª*

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π **MIT**.
